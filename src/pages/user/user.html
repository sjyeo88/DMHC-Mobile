<!--
  Generated template for the UserPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <ion-title>계정정보</ion-title>
  </ion-navbar>

</ion-header>

<ion-content class="register" [formGroup]="fm.reg">
    <ion-list [formGroup]="userInfoGroup">
      <ion-list-header>회원정보 변경하기</ion-list-header>
      <ion-item>
        <ion-label color="primary" stacked>이메일 주소<br></ion-label>
        <ion-input formControlName="email"></ion-input>
        <button ion-button item-right (tap)="confirmAlert(applyType.email)">변경하기</button>
      </ion-item>
      <label class="invalid-msg" *ngIf="email.dirty && email.errors?.pattern">{{validMsg.emailLabel.invalid}}</label>
      <label class="invalid-msg" *ngIf="email.dirty && email.errors?.required">{{validMsg.emailLabel.require}}</label>
      <label class="invalid-msg" *ngIf="email.dirty && isUser">{{validMsg.emailLabel.invalidPattern}}</label>

      <ion-item>
        <ion-label stacked color="primary">이름</ion-label>
        <ion-input class="readonly" formControlName="name" placeholder="회원님의 이름을 입력해주세요" type="text"></ion-input>
      </ion-item>
      <label class="invalid-msg" *ngIf="name.dirty && name.errors?.required">입력이 되지 않았습니다.</label>
      <label class="invalid-msg" *ngIf="name.dirty && name.errors?.maxlength">{{ validMsg.usernameLabel.invalidMax }}</label>

      <ion-item>
        <ion-label color="primary" stacked>성별</ion-label>
        <ion-select
        class="readonly"
        formControlName="gender"
        placeholder="회원님의 성별을 선택해주세요">
          <ion-option value="0">남성</ion-option>
          <ion-option value="1">여성</ion-option>
        </ion-select>
        <button ion-button item-right (tap)="confirmAlert(applyType.gender)">변경하기</button>
      </ion-item>

      <ion-item>
        <ion-label class="readonly" color="primary" stacked>생년월일</ion-label>
        <ion-datetime
        class="readonly"
        formControlName="birth"
        displayFormat="YYYY년 MM월 D일"
        pickerFormat="YYYY MM D"
        placeholder="회원님의 생년월일을 입력해주세요"></ion-datetime>
        <button ion-button item-right (tap)="confirmAlert(applyType.birth)">변경하기</button>
      </ion-item>
      <label class="invalid-msg" *ngIf="birth.dirty && birth.errors?.required">입력이 되지 않았습니다.</label>

      <ion-item>
        <ion-label stacked color="primary">휴대폰 번호<br>("-" 없이 숫자로만 이루어져야 합니다.)</ion-label>
        <ion-input formControlName="phone" placeholder="휴대폰 번호를 (-)없이 입력해주세요" type="text"></ion-input>
        <button ion-button item-right (tap)="confirmAlert(applyType.phone)">변경하기</button>
      </ion-item>
      <label class="invalid-msg" *ngIf="phone.dirty && phone.errors?.pattern">{{validMsg.phoneNumLabel.invalidPattern}}</label>
      <label class="invalid-msg" *ngIf="phone.dirty && phone.errors?.maxlength">{{validMsg.phoneNumLabel.invalidMax}}</label>
      <label class="invalid-msg" *ngIf="phone.dirty && phone.errors?.minlength">{{validMsg.phoneNumLabel.invalidMin}}</label>
      <label class="invalid-msg" *ngIf="phone.dirty && phone.errors?.required">입력이 되지 않았습니다.</label>
    </ion-list>



  <ion-list>
    <ion-list-header> 비밀번호 변경하기 </ion-list-header>
    <div [formGroup]="passwordGroup">
      <ion-item>
        <ion-label color="primary" stacked>새 비밀번호 (숫자, 특수문자, 문자 조합)</ion-label>
        <ion-input formControlName="newPassword" placeholder="새 비밀번호를 입력해주세요" type="password"></ion-input>
      </ion-item>
      <label class="invalid-msg" *ngIf="newPassword.dirty && newPassword.errors?.required">{{validMsg.passwordLabel.require}}</label>
      <label class="invalid-msg" *ngIf="newPassword.dirty && newPassword.errors?.pattern">{{validMsg.passwordLabel.invalidPattern}}</label>
      <label class="invalid-msg" *ngIf="newPassword.dirty && newPassword.errors?.maxlength">{{validMsg.passwordLabel.invalidMax}}</label>
      <label class="invalid-msg" *ngIf="newPassword.dirty && newPassword.errors?.minlength">{{validMsg.passwordLabel.invalidMin}}</label>

      <ion-item>
        <ion-label color="primary" stacked>새 비밀번호 확인</ion-label>
        <ion-input formControlName="passwordCheck" placeholder="새 비밀번호를 다시 입력해주세요" type="password"></ion-input>
      </ion-item>
      <label class="invalid-msg" *ngIf="passwordCheck.dirty && passwordGroup.errors?.match">{{validMsg.passwordCheckLabel.invalid}}</label>
    </div>
  </ion-list>
  <button ion-button (tap)="confirmAlert(applyType.password)">비밀번호 변경하기</button>

  <ion-list>
    <ion-list-header> 비밀번호 질문/답변 변경하기 </ion-list-header>
    <ion-item>
      <ion-label class="readonly" color="primary"  stacked>질문</ion-label>
      <ion-select class="readonly" formControlName="password_q">
        <ion-option value="0">나의 출신 초등학교는?</ion-option>
        <ion-option value="1">나의 아버지 성함은?</ion-option>
        <ion-option value="2">나의 어머니 성함은?</ion-option>
        <ion-option value="3">나의 가장 친한 친구는?</ion-option>
      </ion-select>
    </ion-item>
    <ion-item>
      <ion-label color="primary" stacked> 답변 </ion-label>
      <ion-input formControlName="password_a" placeholder="위 항목에 대한 답변을 해주세요." type="text"></ion-input>
    </ion-item>
    <label class="invalid-msg" *ngIf="password_a.dirty && password_a.errors?.required">입력이 되지 않았습니다.</label>
  </ion-list>
  <button ion-button (tap)="confirmAlert(applyType.passwordQa)">비밀번호 질문/답변 변경하기</button>




  <ion-list>
    <ion-list-header>담당선생님 변경하기</ion-list-header>
    <div [formGroup]="expertGroup">
      <ion-item>
        <ion-label stacked color="primary">담당선생님의 성명을 입력해주세요</ion-label>
        <ion-input formControlName="expert_name" placeholder="담당 선생님의 이름을 입력해주세요" type="text"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label color="primary" stacked>담당 선생님 소속</ion-label>
        <ion-select  formControlName="expert_dept" placeholder="담당 선생님의 소속을 입력해주세요">
          <ion-option *ngFor="let item of dept" [value]="item.idDEPT">{{item.name}}</ion-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label color="primary" stacked>담당 선생님 직종</ion-label>
        <ion-select  formControlName="expert_job" placeholder="담당 선생님의 직종을 입력해주세요">
          <ion-option *ngFor="let item of jobs" [value]="item.idJOBS">{{item.name}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-spinner *ngIf="isGettingExpert" name="bubbles"></ion-spinner>
      <label
      class="invalid-msg"
      *ngIf="!isGettingExpert && !foundExpert && expertGroup?.dirty"
      >
        조건을 만족하는 선생님을 찾을 수 없습니다.<br>다시한번 확인해주세요.
      </label>
      <label
      class="valid-msg"
      *ngIf="!isGettingExpert && foundExpert && !dupEXPERT && expertGroup?.dirty && isChangedExpertUser">
        조건을 만족하는 선생님을 찾았습니다.
      </label>
      <label
      class="valid-msg"
      *ngIf="!isGettingExpert && dupEXPERT && expertGroup?.dirty">
        조건을 만족하는 선생님이 한 명 이상 있습니다.
        <br>
        변경하시려면 관리자에게 연락바랍니다.
      </label>
      <label
      class="invalid-msg"
      *ngIf="!isGettingExpert && foundExpert && !dupEXPERT && expertGroup?.dirty && !isChangedExpertUser">
        기존 담당 선생님과 동일합니다.
      </label>
    </div>
  </ion-list>

  <button class="last-item" ion-button (tap)="confirmAlert(applyType.expert)">담당선생님 변경하기</button>
</ion-content>
